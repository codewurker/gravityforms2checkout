window.GF2Checkout=null,function(s){a11yErrorHandler=function(e){this.speechMessages=[],this.speaker=null,this.errors={},this.types=e.fields,this.push=function(e,t){e=this.getErrorType(e),this.errors[e]=t,this.declareError(e,t),setTimeout(this.speak.bind(this),500)},this.remove=function(e){e=this.getErrorType(e),this.errors[e]=null,this.clearError(e)},this.allGood=function(){Object.keys(this.errors).forEach(function(e,t){this.clearError(e)}.bind(this))},this.getErrorType=function(e){return e=null==e||!e in this.types?"generic":e},this.clearError=function(e){var t=this.getFieldContainer(e),i=t.next(".validation_message");i.length&&i.find("div."+e).remove(),t.removeClass("is-error")},this.declareError=function(e,t){var i,n=this.getFieldContainer(e);n.addClass("is-error"),n.next(".validation_message").length||n.after('<div class="gfield_description validation_message"></div>'),(i=n.next(".validation_message").find("div."+e)).length?i.text()!==t&&i.text(t):n.next(".validation_message").append('<div class="'+e+'">'+t+"</div>"),this.speechMessages.push(t)},this.speak=function(){null===this.speaker&&(this.speaker=setTimeout(function(){var i="";this.speechMessages.filter(function(e,t,i){return i.indexOf(e)===t}).forEach(function(e,t){i+="\n"+e}),wp.a11y.speak(i),this.speaker=null,this.speechMessages=[]}.bind(this),250))},this.getFieldContainer=function(e){return"generic"===e?s(".gf2checkout-creditcard"):["cardNumber","expirationDate","cvv","postalCode"].includes(e)?s(".gf2checkout-creditcard-details"):s("gf2checkout-creditcard-name")}},GF2Checkout=function(e){var t,a=this;for(t in a.form=null,a.jsPaymentClient=null,e)e.hasOwnProperty(t)&&(this[t]=e[t]);a.get2Pay=function(){return a.jsPaymentClient},a.errorStack=null,a.fields=["cardHolderName"],a.init=function(){var o;a.isCreditCardOnPage()&&((o=this).merchantCode,this.secretKey,this.form=s("#gform_"+this.formId),this.GFCCField=s("#input_"+this.formId+"_"+this.ccFieldId+"_1"),a.resetPaymentForm(),a.errorStack=new a11yErrorHandler(o),gform.addAction("gform_frontend_feeds_evaluated",function(e,t){if(t===o.formId){for(var i=!1,n=Object.keys(e).length,r=0;r<n;r++)if("gravityforms2checkout"===e[r].addonSlug&&e[r].isActivated&&a.isCreditCardOnPage()){a.initPaymentForm(),i=!0;break}i||a.resetPaymentForm(),s("#gform_"+a.formId).on("submit",function(e){a.form=s(this),!s(this).data("gf_2checkout_submitting")&&1!=s("#gform_save_"+a.formId).val()&&a.isCreditCardOnPage()&&(e.preventDefault(),s(this).data("gf_2checkout_submitting",!0),a.maybeAddSpinner(),e={name:a.form.find("#input_"+a.formId+"_"+a.ccFieldId+"_5").val()},o.jsPaymentClient.tokens.generate(o.component,e).then(function(e){a.errorStack.allGood(),a.form.append(s('<input type="hidden" name="2checkout_response" />').val(e.token)),a.form.submit()}).catch(function(e){return a.resetFormStatus(a.form,a.formId,a.isLastPage()),a.errorStack.push("generic",e),!1}))})}}))},a.buildPaymentForm=function(){null!==a.jsPaymentClient&&s("#input_"+a.formId+"_"+a.ccFieldId+"_1").html(""),a.jsPaymentClient=new TwoPayClient(a.merchantCode),a.component=a.jsPaymentClient.components.create("card",{margin:0,fontFamily:"Helvetica, sans-serif",fontSize:"1rem",fontWeight:"400",lineHeight:"1.5",color:"#212529",textAlign:"left",backgroundColor:"transparent","*":{boxSizing:"border-box"},".no-gutters":{marginRight:0,marginLeft:0},".row":{display:"flex",flexWrap:"wrap",height:"96px"},".col":{flexBasis:"0",flexGrow:"1",maxWidth:"100%",padding:"0",position:"relative",width:"100%"},".two-co-iframe-hidden-tabbable":{display:"none"},div:{display:"block"},".field-container":{paddingBottom:"14px"},".input-wrapper":{position:"relative"},label:{display:"inline-block",marginBottom:"9px",color:"#313131",fontSize:"14px",fontWeight:"300",lineHeight:"17px"},input:{overflow:"visible",margin:0,fontFamily:"inherit",display:"block",width:"100%",height:"42px",padding:"10px 12px",fontSize:"18px",fontWeight:"400",lineHeight:"22px",color:"#313131",backgroundColor:"#fff",backgroundClip:"padding-box",border:"1px solid #CBCBCB",borderRadius:"3px",transition:"border-color .15s ease-in-out,box-shadow .15s ease-in-out",outline:0},".is-error input":{border:"1px solid #D9534F"},".is-valid input":{border:"1px solid #1BB43F"},".validation-message":{color:"#c02b0a",fontSize:"10px",fontStyle:"italic",marginTop:"6px",marginBottom:"-5px",display:"block",lineHeight:"1"},".card-expiration-date":{paddingRight:".5rem"},".is-empty input":{color:"#EBEBEB"},".lock-icon":{top:"calc(50% - 7px)",right:"10px"},".valid-icon":{display:"none"},".error-icon":{display:"none"},".card-icon":{top:"calc(50% - 10px)",left:"10px",display:"none"},".is-empty .card-icon":{display:"block"},".is-focused .card-icon":{display:"none"},".card-type-icon":{right:"30px",display:"block"},".card-type-icon.visa":{top:"calc(50% - 14px)"},".card-type-icon.mastercard":{top:"calc(50% - 14.5px)"},".card-type-icon.amex":{top:"calc(50% - 14px)"},".card-type-icon.discover":{top:"calc(50% - 14px)"},".card-type-icon.jcb":{top:"calc(50% - 14px)"},".card-type-icon.dankort":{top:"calc(50% - 14px)"},".card-type-icon.cartebleue":{top:"calc(50% - 14px)"},".card-type-icon.diners":{top:"calc(50% - 14px)"},".card-type-icon.elo":{top:"calc(50% - 14px)"}}),a.component.mount("#input_"+a.formId+"_"+a.ccFieldId+"_1"),s("#input_"+a.formId+"_"+a.ccFieldId+"_5_container").css("display","")},a.isConversationalForm=function(){return"undefined"!=typeof gfcf_theme_config&&(null!==gfcf_theme_config&&void 0!==gfcf_theme_config.data?gfcf_theme_config.data.is_conversational_form:void 0)},a.initPaymentForm=function(){s("#field_"+a.formId+"_"+a.ccFieldId).is(":visible")||this.isConversationalForm()?a.buildPaymentForm():gform.addAction("gform_post_conditional_logic_field_action",function(e,t,i){"show"===t&&"#field_"+a.formId+"_"+a.ccFieldId===i&&a.buildPaymentForm()})},a.resetPaymentForm=function(){a.jsPaymentClient=null,s("#input_"+a.formId+"_"+a.ccFieldId+"_1").html(""),s("#input_"+a.formId+"_"+a.ccFieldId+"_5_container").hide()},this.resetFormStatus=function(e,t,i){e.data("gf_2checkout_submitting",!1),s("#gform_ajax_spinner_"+t).remove(),i&&(window["gf_submitting_"+t]=!1)},a.getCurrentPageNumber=function(){var e=s("#gform_source_page_number_"+a.formId);return 0<e.length&&e.val()},a.isCreditCardOnPage=function(){var e=a.getCurrentPageNumber();return!(a.ccPage&&e&&!this.isConversationalForm())||this.ccPage==e},a.isLastPage=function(){var e=s("#gform_target_page_number_"+a.formId);return!(0<e.length)||0==e.val()},a.maybeAddSpinner=function(){var e;a.isAjax||("function"==typeof gformAddSpinner?gformAddSpinner(a.formId):0==s("#gform_ajax_spinner_"+a.formId).length&&(e=gform.applyFilters("gform_spinner_url",gf_global.spinnerUrl,a.formId),gform.applyFilters("gform_spinner_target_elem",s("#gform_submit_button_"+a.formId+", #gform_wrapper_"+a.formId+" .gform_next_button, #gform_send_resume_link_button_"+a.formId),a.formId).after('<img id="gform_ajax_spinner_'+a.formId+'"  class="gform_ajax_spinner" src="'+e+'" alt="" />')))},a.init()}}(jQuery);